# Main vhost for dashboard users
Listen 3000
<VirtualHost *:3000>

	ServerName puppet

	SSLEngine on
	SSLProtocol -ALL +SSLv3 +TLSv1
	SSLCipherSuite ALL:!ADH:RC4+RSA:+HIGH:+MEDIUM:-LOW:-SSLv2:-EXP

	SSLCertificateFile 		/usr/share/puppet-dashboard/certs/dashboard.cert.pem
	SSLCertificateKeyFile 	/usr/share/puppet-dashboard/certs/dashboard.private_key.pem
	SSLCACertificateFile	/usr/share/puppet-dashboard/certs/dashboard.ca_cert.pem

	# If Apache complains about invalid signatures on the CRL, you can try disabling
	# CRL checking by commenting the next line, but this is not recommended.
	SSLCARevocationFile	   /usr/share/puppet-dashboard/certs/dashboard.ca_crl.pem

	SSLVerifyClient optional
	SSLVerifyDepth  1
	SSLOptions +StdEnvVars

	DocumentRoot /usr/share/puppet-dashboard/public
	<Directory /usr/share/puppet-dashboard/public>
		Options None
		AllowOverride None
		Order allow,deny
		allow from all
	</Directory>
	
	<Location / >
		Order deny,allow
		Allow from all
		# Enable this to require client-side certificates for Dashboard connections
		#SSLVerifyClient require
	</Location>
	
</VirtualHost>

# Allow puppet to connect for node definition and reporting purposes
Listen 3001
<VirtualHost *:3001>

	ServerName puppet

	DocumentRoot /usr/share/puppet-dashboard/public
	<Directory /usr/share/puppet-dashboard/public>
		Options None
		AllowOverride None
		Order allow,deny
		allow from puppet
	</Directory>

</VirtualHost>
